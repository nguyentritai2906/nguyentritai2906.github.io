<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Oauth2 - The concept | NguyenTriTai</title>
<meta name="keywords" content="Authentication, Authorization, OAuth2" />
<meta name="description" content="Have you ever wonder how &#39;Login with Google&#39; or &#39;Login with Facebook&#39; work? Here&#39;s a brief overview of OAuth2 protocol.">
<meta name="author" content="Nguyen Tri Tai">
<link rel="canonical" href="https://blog.nguyentritai.io/posts/2023/oauth2/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.258309a8cbd70e6f8f22e7e835f7cf1dbd70d1c793875353813389b8419684d9.css" integrity="sha256-JYMJqMvXDm&#43;PIufoNffPHb1w0ceTh1NTgTOJuEGWhNk=" rel="preload stylesheet" as="style">
<link rel="preload" href="/avatar.png" as="image">
<link rel="icon" href="https://blog.nguyentritai.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.nguyentritai.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.nguyentritai.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.nguyentritai.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.nguyentritai.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.0" />
<link rel="alternate" hreflang="en" href="https://blog.nguyentritai.io/posts/2023/oauth2/" />

<meta property="og:title" content="Oauth2 - The concept" />
<meta property="og:description" content="Have you ever wonder how &#39;Login with Google&#39; or &#39;Login with Facebook&#39; work? Here&#39;s a brief overview of OAuth2 protocol." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.nguyentritai.io/posts/2023/oauth2/" />
<meta property="og:image" content="https://blog.nguyentritai.io/posts/2023/oauth2/cover.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-01T13:31:22&#43;07:00" />
<meta property="article:modified_time" content="2023-03-01T13:31:22&#43;07:00" /><meta property="og:site_name" content="NguyenTriTai" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://blog.nguyentritai.io/posts/2023/oauth2/cover.jpg" />
<meta name="twitter:title" content="Oauth2 - The concept"/>
<meta name="twitter:description" content="Have you ever wonder how &#39;Login with Google&#39; or &#39;Login with Facebook&#39; work? Here&#39;s a brief overview of OAuth2 protocol."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.nguyentritai.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Oauth2 - The concept",
      "item": "https://blog.nguyentritai.io/posts/2023/oauth2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Oauth2 - The concept",
  "name": "Oauth2 - The concept",
  "description": "Have you ever wonder how 'Login with Google' or 'Login with Facebook' work? Here's a brief overview of OAuth2 protocol.",
  "keywords": [
    "Authentication", "Authorization", "OAuth2"
  ],
  "articleBody": "OAuth2 The OAuth 2.0 Authorization Framework is an open-standard authorization protocol or framework that provides applications the ability for secure access to protected resources without giving them the password. The key concepts of OAuth include resource owners, clients, authorization server, access tokens, and scopes.\n Resource owners are entities capable of authorizing access to a protected resource (e.g. user). Clients are third-party applications that want access to a protected resource (e.g. application). Authorization servers are responsible for verifying authorization grants and issuing access tokens (e.g. Keycloak). Access tokens are used to access protected resources (i.e. JWT token). Scopes are used to limit the amount of access that an OAuth client has to a protected resource (e.g. read-only)  Introduction  In the traditional client-server authentication model, the client requests an access-restricted resource (protected resource) on the server by authenticating with the server using the resource owner’s credentials. In order to provide third-party applications access to restricted resources, the resource owner shares its credentials with the third party\n Limitation:\n Third-party are required to store credentials (e.g: password). Servers are required to support password authentication. Third-party has no restrictions on the resources they can access. Resource owners cannot revoke access to a third-party. Security compromise casscade down to end-user’s password and data.  Instead of using resource owner’s credentials, OAuth uses access tokens to access protected resources. Access tokens are issued by the authorization server and are short-lived. Access tokens are NOT used to authenticate the client, but instead are used to identify the client and authorize access to the protected resource.\nProtocol Flow +--------+ +---------------+ | |--(A)- Authorization Request -| Resource | | | | Owner | | || Authorization | | Client | | Server | | || Resource | | | | Server | | |OAuth Protocol Flow is the process that allows an application to request authorization to access a user’s data. It involves the user granting permission to the application, the application sending an authorization request to the authorization server, and the authorization server responding with an access token which can be used to request the user’s data. The protocol flow is divided into four steps:\n The user grants the application permission to access their data by clicking on a “Login with…” button or similar. The application then sends an authorization request to the authorization server which contains information about the application, the user, and the data the application is requesting access to. The authorization server then responds with an access token which is used to request the user’s data. The application then sends a request to the resource server with the access token, and the resource server responds with the requested data.  Grant Types Authorization grants are credentials representing the resource owner’s authorization (to access its protected resources) expressed in a specific manner, for the specific purpose of being exchanged for an access token.\nThere are four grant types:\n Authorization Code Grant: Used when the client needs to access resources that are owned by the user, such as when the user needs to log into an application or grant access to their data Implicit Grant: Used when the client needs to access resources on behalf of a user without the user having to provide credentials. Resource Owner Password Credentials Grant: Used when the client needs to access resources that are owned by the user, but the user does not need to log in or provide credentials. Client Credentials Grant: Used when the client needs to access resources that the client owns, such as when the client needs to make requests on its own behalf.  Authorization Code Grant Instead of requesting authorization directly from resource owner, the client application requests authorization from the authorization server. The authorization server authenticates the resource owner and obtains authorization. The authorization server then issues an authorization code to the client application. The client application then exchanges the authorization code for an access token.\nThe Authorization Code grant type is the most secure of the OAuth 2.0 grant types and provides the highest level of assurance that the access token is only issued to the intended client application\nImplicit Grant The Implicit Grant type is an OAuth 2.0 authorization flow that does not require an intermediate code exchange step. Instead, the client-side application directly requests an access token from the authorization server, and the authorization server directly issues the access token to the client-side application. The Implicit grant type is suitable for client-side applications (such as JavaScript apps) where the client secret can’t be securely stored. It is also used in mobile applications where the client secret is not available.\nThe Implicit grant flow is similar to the Authorization Code grant flow, except that it does not require the client to exchange an authorization code for an access token. Instead, the authorization server responds with an access token directly and can be verify via the access token’s signature.\nResource Owner Password Credentials Grant When there is a high degree of trust between the resource owner and the client (e.g. the client is part of the device), the resource owner password credentials (i.e. username and password) can be used to obtain an access token directly.\nClient Credentials Grant OAuth2 Client Credentials grant is an authorization flow used by clients to obtain an access token outside of the context of a user. In this flow, the client will send its own credentials (usually in the form of a client ID and a client secret) to the authorization server, which will then respond with an access token. This access token can then be used to access the client’s own resources, not on behalf of a user. This type of flow is typically used by applications that need to access their own APIs, such as for backend services.\nAccess Token An OAuth 2 Access Token is a string that is used to authenticate a user and grant access to an API. They are issued by an authorization server, typically after a user has successfully authenticated and given their consent to access the API. Access tokens are used to make requests to the API on behalf of the user, and usually have a limited lifetime. Access tokens may also be revoked by the user or the authorization server at any time. Access tokens are typically encoded using the JWT (JSON Web Token) format, which includes the user’s identity, the scope of the API access granted, an expiration time and other security-related information like a signature.\nRefresh Token A refresh token is a special kind of token that is used to obtain a new access token. It is issued to the client by the authorization server and is used to obtain a new access token when the current access token becomes invalid or expires.\n+--------+ +---------------+ | |--(A)------- Authorization Grant ---------| | | | | | | || | | | | | | | | | | || | | | | | | | | | | || | | | | | | |Clients Client registration Before initiating the protocol, the client registers with the authorization server\nIn order to register a client, client developers needs to:\n Specify client type Provide client redirect URIs  Client types There are two types of clients:\n Confidential: Clients that can keep their credentials confidential (e.g. web applications) Public: Clients that cannot keep their credentials confidential (e.g. mobile applications)  Clients can have multiple components, such as a web application and a mobile application. In this case, the client have different client types and security context and should be registered separately.\nOAuth 2.0 defines three different classes of clients:\n web applications: store the client credentials on a server (e.g. web server) user-agent-based applications: execute code within a user agent (e.g. web browser) native applications: installed on a user’s device (e.g. mobile phone or tablet)   This specification has been designed around the following client profiles:\n  web application\nA web application is a confidential client running on a web server. Resource owners access the client via an HTML user interface rendered in a user-agent on the device used by the resource owner. The client credentials as well as any access token issued to the client are stored on the web server and are not exposed to or accessible by the resource owner.\n  user-agent-based application\nA user-agent-based application is a public client in which the client code is downloaded from a web server and executes within a user-agent (e.g., web browser) on the device used by the resource owner. Protocol data and credentials are easily accessible (and often visible) to the resource owner. Since such applications reside within the user-agent, they can make seamless use of the user-agent capabilities when requesting authorization.\n  native application\nA native application is a public client installed and executed on the device used by the resource owner. Protocol data and credentials are accessible to the resource owner. It is assumed that any client authentication credentials included in the application can be extracted. On the other hand, dynamically issued credentials such as access tokens or refresh tokens can receive an acceptable level of protection. At a minimum, these credentials are protected from hostile servers with which the application may interact. On some platforms, these credentials might be protected from other applications residing on the same device.\n   Client identifier Client ID is a unique string that is used to identify the client application when it requests access to a user’s resources from an authorization server. It is used to verify that the application is registered and trusted by the authorization server, and to ensure that the application is not attempting to gain access to resources it does not have permission to access. It is also used to help the authorization server track the application’s access to the user’s resources.\nClient authentication Client Authentication is a process used to verify a client application’s identity when requesting access to a user’s resources from an authorization server. This process helps to ensure that the application is registered and trusted, and that it is not attempting to gain access to resources it does not have permission to access. The process typically involves the client application providing a unique identifier and a secret key, which the authorization server can use to authenticate the client. In addition, the authorization server may require additional authentication methods, such as a certificate or a user’s username and password.\nClient password Clients can be assigned a password that is used to authenticate the client when it requests access to a user’s. It can be used to authenticate with authorization server via the HTTP Basic authentication scheme.\n The client identifier is encoded using the “application/x-www-form-urlencoded” encoding algorithm per Appendix B, and the encoded value is used as the username; the client password is encoded using the same algorithm and used as the password\n E.g.:\n Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3  Alternatively, but NOT RECOMMENDED, the client can authenticate with the authorization server using the client_id and client_secret in the request body using:\n client_id as the username client_secret as the password  Protocol endpoints The authorization process utilizes 2 endpoints:\n Authorization endpoint: used to interact with the resource owner and obtain an authorization grant. Token endpoint: used by the client to obtain an access token by presenting its authorization grant or refresh token.  Authorization endpoint The authorization endpoint is used to interact with the resource owner and obtain an authorization grant.\nResponse types:\n code: for requesting an authorization code. token: for requesting an access token (implicit grant).  Token endpoint The token endpoint allows clients to obtain access token and refresh token. This endpoint is used with every authorization grant except for the implicit grant type (since an access token is issued directly).\nA client will usually send an authorization grant (such as an authorization code) to the token endpoint, and the endpoint will return an access token and a refresh token. The access token is used to gain access to protected resources, while the refresh token is used to obtain a new access token when the current one expires.\nThe token endpoint can also be used to revoke access tokens, and to obtain additional information about the token, such as its expiration time.\nObtaining Authorization Authorization code grant The authorization code flow involves the following steps:\n The client initiates the flow by redirecting the user to the authorization server. The user authenticates with the authorization server and grants the client access. The authorization server sends an authorization code back to the client application. The client application exchanges the authorization code for an access token. The client application can use the access token to make API requests.  +----------+ | Resource | | Owner | | | +----------+ ^ | (B) +----|-----+ Client Identifier +---------------+ | -+----(A)-- \u0026 Redirection URI ----| | | User- | | Authorization | | Agent -+----(B)-- User authenticates ---| Server | | | | | | -+----(C)-- Authorization Code ------(D)-- Authorization Code ---------' | | Client | \u0026 Redirection URI | | | | | |Implicit grant The implicit grant flow involves the following steps:\n The client initiates the flow by redirecting the user to the authorization server. The user authenticates with the authorization server and grants the client access. The authorization server sends an access token back to the client application. The client application can use the access token to make API requests.  +----------+ | Resource | | Owner | | | +----------+ ^ | (B) +----|-----+ Client Identifier +---------------+ | -+----(A)-- \u0026 Redirection URI ---| | | User- | | Authorization | | Agent -|----(B)-- User authenticates --| Server | | | | | | || Web-Hosted | | | without Fragment | Client | | | | Resource | | (F) |Resource owner password credentials grant The resource owner password credentials grant flow involves the following steps:\n The client application requests an access token from the authorization server by providing the resource owner’s credentials. The authorization server validates the credentials and sends an access token back to the client application.  +----------+ | Resource | | Owner | | | +----------+ v | Resource Owner (A) Password Credentials | v +---------+ +---------------+ | |--(B)---- Resource Owner -------| | | | Password Credentials | Authorization | | Client | | Server | | |Client credentials grant The client credentials grant flow involves the following steps:\n The client application requests an access token from the authorization server by providing its client credentials. The authorization server validates the credentials and sends an access token back to the client application.  +---------+ +---------------+ | |--(A)- Client Authentication ---| | | Client | | Authorization | | |",
  "wordCount" : "2737",
  "inLanguage": "en",
  "image":"https://blog.nguyentritai.io/posts/2023/oauth2/cover.jpg","datePublished": "2023-03-01T13:31:22+07:00",
  "dateModified": "2023-03-01T13:31:22+07:00",
  "author":{
    "@type": "Person",
    "name": "Nguyen Tri Tai"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.nguyentritai.io/posts/2023/oauth2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "NguyenTriTai",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.nguyentritai.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.nguyentritai.io/" accesskey="h" title="NguyenTriTai (Alt + H)">NguyenTriTai</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://blog.nguyentritai.io/vi/" title="Vietnamese"
                            aria-label=":vi:">Vi</a>
                    </li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.nguyentritai.io/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://blog.nguyentritai.io/archive" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://blog.nguyentritai.io/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://blog.nguyentritai.io/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://blog.nguyentritai.io/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://blog.nguyentritai.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
    <header class="post-header">
        <div class="breadcrumbs"><a href="https://blog.nguyentritai.io/">Home</a>&nbsp;»&nbsp;<a href="https://blog.nguyentritai.io/posts/">Posts</a></div>
        <h1 class="post-title">
            Oauth2 - The concept
        </h1>
        <div class="post-description">
            Have you ever wonder how &#39;Login with Google&#39; or &#39;Login with Facebook&#39; work? Here&#39;s a brief overview of OAuth2 protocol.
        </div>
        <div class="post-meta">March 1, 2023&nbsp;·&nbsp;13 min&nbsp;·&nbsp;Nguyen Tri Tai
</div>
    </header> 
<figure class="entry-cover">
        <img loading="lazy" srcset="https://blog.nguyentritai.io/posts/2023/oauth2/cover_hu81b11467b5f50ec0e852bbd8a50ab9d2_113653_360x0_resize_q75_box.jpg 360w ,https://blog.nguyentritai.io/posts/2023/oauth2/cover_hu81b11467b5f50ec0e852bbd8a50ab9d2_113653_480x0_resize_q75_box.jpg 480w ,https://blog.nguyentritai.io/posts/2023/oauth2/cover_hu81b11467b5f50ec0e852bbd8a50ab9d2_113653_720x0_resize_q75_box.jpg 720w ,https://blog.nguyentritai.io/posts/2023/oauth2/cover.jpg 901w"
            sizes="(min-width: 768px) 720px, 100vw" src="https://blog.nguyentritai.io/posts/2023/oauth2/cover.jpg" alt="OAuth2 FLow Diagram" />
        <p>OAuth2 FLow Diagram</p>
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <div class="details">Table of Contents</div>
        </summary>
        <div class="inner"><ul>
                <li>
                    <a href="#oauth2" aria-label="OAuth2">OAuth2</a><ul>
                        
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a><ul>
                        
                <li>
                    <a href="#protocol-flow" aria-label="Protocol Flow">Protocol Flow</a></li>
                <li>
                    <a href="#grant-types" aria-label="Grant Types">Grant Types</a><ul>
                        
                <li>
                    <a href="#authorization-code-grant" aria-label="Authorization Code Grant">Authorization Code Grant</a></li>
                <li>
                    <a href="#implicit-grant" aria-label="Implicit Grant">Implicit Grant</a></li>
                <li>
                    <a href="#resource-owner-password-credentials-grant" aria-label="Resource Owner Password Credentials Grant">Resource Owner Password Credentials Grant</a></li>
                <li>
                    <a href="#client-credentials-grant" aria-label="Client Credentials Grant">Client Credentials Grant</a></li></ul>
                </li>
                <li>
                    <a href="#access-token" aria-label="Access Token">Access Token</a></li>
                <li>
                    <a href="#refresh-token" aria-label="Refresh Token">Refresh Token</a></li></ul>
                </li>
                <li>
                    <a href="#clients" aria-label="Clients">Clients</a><ul>
                        
                <li>
                    <a href="#client-registration" aria-label="Client registration">Client registration</a></li>
                <li>
                    <a href="#client-types" aria-label="Client types">Client types</a></li>
                <li>
                    <a href="#client-identifier" aria-label="Client identifier">Client identifier</a></li>
                <li>
                    <a href="#client-authentication" aria-label="Client authentication">Client authentication</a></li>
                <li>
                    <a href="#client-password" aria-label="Client password">Client password</a></li></ul>
                </li>
                <li>
                    <a href="#protocol-endpoints" aria-label="Protocol endpoints">Protocol endpoints</a><ul>
                        
                <li>
                    <a href="#authorization-endpoint" aria-label="Authorization endpoint">Authorization endpoint</a></li>
                <li>
                    <a href="#token-endpoint" aria-label="Token endpoint">Token endpoint</a></li></ul>
                </li>
                <li>
                    <a href="#obtaining-authorization" aria-label="Obtaining Authorization">Obtaining Authorization</a><ul>
                        
                <li>
                    <a href="#authorization-code-grant-1" aria-label="Authorization code grant">Authorization code grant</a></li>
                <li>
                    <a href="#implicit-grant-1" aria-label="Implicit grant">Implicit grant</a></li>
                <li>
                    <a href="#resource-owner-password-credentials-grant-1" aria-label="Resource owner password credentials grant">Resource owner password credentials grant</a></li>
                <li>
                    <a href="#client-credentials-grant-1" aria-label="Client credentials grant">Client credentials grant</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

    <div class="post-content"><h1 id="oauth2">OAuth2<a hidden class="anchor" aria-hidden="true" href="#oauth2">#</a></h1>
<p><a href="https://datatracker.ietf.org/doc/html/rfc6749">The OAuth 2.0 Authorization Framework</a> is an open-standard authorization
protocol or framework that provides applications the ability for <strong>secure access
to protected resources</strong> without giving them the password. The key concepts of OAuth include <strong>resource owners</strong>,
<strong>clients</strong>, <strong>authorization server</strong>, <strong>access tokens</strong>, and <strong>scopes</strong>.</p>
<ul>
<li><strong>Resource owners</strong> are entities capable of authorizing access to a protected resource (e.g. user).</li>
<li><strong>Clients</strong> are third-party applications that want access to a protected resource (e.g. application).</li>
<li><strong>Authorization servers</strong> are responsible for verifying authorization grants and issuing access tokens (e.g. Keycloak).</li>
<li><strong>Access tokens</strong> are used to access protected resources (i.e. JWT token).</li>
<li><strong>Scopes</strong> are used to limit the amount of access that an OAuth client has to a protected resource (e.g. read-only)</li>
</ul>
<h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<blockquote>
<p>In the traditional client-server authentication model, the client
requests an <strong>access-restricted resource (protected resource)</strong> on the
server by authenticating with the server using the <strong>resource owner&rsquo;s
credentials</strong>.  In order to provide third-party applications access to
restricted resources, the <strong>resource owner shares its credentials</strong> with
the third party</p>
</blockquote>
<p>Limitation:</p>
<ul>
<li>Third-party are <strong>required to store credentials</strong> (e.g: password).</li>
<li>Servers are <strong>required to support password authentication</strong>.</li>
<li>Third-party has <strong>no restrictions on the resources</strong> they can access.</li>
<li>Resource owners <strong>cannot revoke access</strong> to a third-party.</li>
<li>Security <strong>compromise casscade</strong> down to end-user&rsquo;s password and data.</li>
</ul>
<p>Instead of using resource owner&rsquo;s credentials, OAuth uses <strong>access tokens</strong> to access protected resources. Access tokens are
issued by the authorization server and are <strong>short-lived</strong>. Access tokens are <strong>NOT</strong> used to authenticate the client, but
instead are used to <strong>identify the client</strong> and <strong>authorize access to the protected resource</strong>.</p>
<h3 id="protocol-flow">Protocol Flow<a hidden class="anchor" aria-hidden="true" href="#protocol-flow">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">             +--------+                               +---------------+
             |        |--(A)- Authorization Request -&gt;|   Resource    |
             |        |                               |     Owner     |
             |        |&lt;-(B)-- Authorization Grant ---|               |
             |        |                               +---------------+
             |        |
             |        |                               +---------------+
             |        |--(C)-- Authorization Grant --&gt;| Authorization |
             | Client |                               |     Server    |
             |        |&lt;-(D)----- Access Token -------|               |
             |        |                               +---------------+
             |        |
             |        |                               +---------------+
             |        |--(E)----- Access Token ------&gt;|    Resource   |
             |        |                               |     Server    |
             |        |&lt;-(F)--- Protected Resource ---|               |
             +--------+                               +---------------+

                      Figure 1:  Abstract Protocol Flow
            (https://datatracker.ietf.org/doc/html/rfc6749#section-1.2)
</code></pre></div><p>OAuth Protocol Flow is the process that <strong>allows an application to request authorization</strong> to access a user’s data. It
involves the <em>user granting permission to the application</em>, the <em>application sending an authorization request</em> to the
authorization server, and the <em>authorization server responding with an access token</em> which can be used to request the
user’s data. The protocol flow is divided into four steps:</p>
<ul>
<li>The user grants the application permission to access their data by clicking on a “Login with…” button or similar.</li>
<li>The application then sends an authorization request to the authorization server which contains information about the
application, the user, and the data the application is requesting access to.</li>
<li>The authorization server then responds with an access token which is used to request the user’s data.</li>
<li>The application then sends a request to the resource server with the access token, and the resource server responds
with the requested data.</li>
</ul>
<h3 id="grant-types">Grant Types<a hidden class="anchor" aria-hidden="true" href="#grant-types">#</a></h3>
<p>Authorization grants are credentials representing the resource owner&rsquo;s authorization (to access its protected resources)
expressed in a specific manner, for the specific purpose of being exchanged for an access token.</p>
<p>There are four grant types:</p>
<ul>
<li><strong>Authorization Code Grant</strong>: Used when the client needs to access resources that are owned by the user, such as when the
user needs to log into an application or grant access to their data</li>
<li><strong>Implicit Grant</strong>: Used when the client needs to access resources on behalf of a user without the user having to provide
credentials.</li>
<li><strong>Resource Owner Password Credentials Grant</strong>: Used when the client needs to access resources that are owned by the user,
but the user does not need to log in or provide credentials.</li>
<li><strong>Client Credentials Grant</strong>: Used when the client needs to access resources that the client owns, such as when the client
needs to make requests on its own behalf.</li>
</ul>
<h4 id="authorization-code-grant">Authorization Code Grant<a hidden class="anchor" aria-hidden="true" href="#authorization-code-grant">#</a></h4>
<p>Instead of requesting authorization directly from resource owner, the client application requests authorization from the
authorization server. The authorization server authenticates the resource owner and obtains authorization. The
<strong>authorization server then issues an authorization code</strong> to the client application. The client application then <strong>exchanges
the authorization code for an access token</strong>.</p>
<p>The Authorization Code grant type is the most secure of the OAuth 2.0 grant types and provides the highest level of
assurance that the access token is only issued to the intended client application</p>
<h4 id="implicit-grant">Implicit Grant<a hidden class="anchor" aria-hidden="true" href="#implicit-grant">#</a></h4>
<p>The Implicit Grant type is an OAuth 2.0 authorization flow that <strong>does not require an intermediate code exchange step</strong>.
Instead, the <strong>client-side application directly requests an access token</strong> from the authorization server, and the
<strong>authorization server directly issues the access token</strong> to the client-side application. The Implicit grant type is
suitable for client-side applications (such as JavaScript apps) where the client secret can&rsquo;t be securely stored. It is
also used in mobile applications where the client secret is not available.</p>
<p>The Implicit grant flow is similar to the Authorization Code grant flow, except that it <strong>does not require the client to
exchange an authorization code for an access token</strong>. Instead, the authorization server responds with an access token
directly and can be verify via the <strong>access token&rsquo;s signature</strong>.</p>
<h4 id="resource-owner-password-credentials-grant">Resource Owner Password Credentials Grant<a hidden class="anchor" aria-hidden="true" href="#resource-owner-password-credentials-grant">#</a></h4>
<p>When there is a <strong>high degree of trust</strong> between the resource owner and the client (e.g. the client is part of the device), the
resource owner password credentials (i.e. username and password) can be used to obtain an access token directly.</p>
<h4 id="client-credentials-grant">Client Credentials Grant<a hidden class="anchor" aria-hidden="true" href="#client-credentials-grant">#</a></h4>
<p>OAuth2 Client Credentials grant is an authorization flow used by clients to obtain an access token <strong>outside of the
context of a user</strong>. In this flow, the client will <strong>send its own credentials</strong> (usually in the form of a <strong>client ID and a
client secret</strong>) to the authorization server, which will then respond with an access token. This access token can then be
used to access the client&rsquo;s own resources, not on behalf of a user. This type of flow is typically used by applications
that need to access their own APIs, such as for backend services.</p>
<h3 id="access-token">Access Token<a hidden class="anchor" aria-hidden="true" href="#access-token">#</a></h3>
<p>An OAuth 2 Access Token is a string that is used to authenticate a user and grant access to an API. They are issued by
an authorization server, typically after a user has successfully authenticated and given their consent to access the
API. Access tokens are used to make requests to the API on behalf of the user, and usually have a limited lifetime.
Access tokens may also be revoked by the user or the authorization server at any time. Access tokens are typically
encoded using the JWT (JSON Web Token) format, which includes the user’s identity, the scope of the API access granted,
an expiration time and other security-related information like a signature.</p>
<h3 id="refresh-token">Refresh Token<a hidden class="anchor" aria-hidden="true" href="#refresh-token">#</a></h3>
<p>A refresh token is a special kind of token that is used to <strong>obtain a new access token</strong>. It is issued to the client by the
authorization server and is used to obtain a new access token when the current access token becomes invalid or expires.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">       +--------+                                           +---------------+
       |        |--(A)------- Authorization Grant ---------&gt;|               |
       |        |                                           |               |
       |        |&lt;-(B)----------- Access Token -------------|               |
       |        |               &amp; Refresh Token             |               |
       |        |                                           |               |
       |        |                            +----------+   |               |
       |        |--(C)---- Access Token ----&gt;|          |   |               |
       |        |                            |          |   |               |
       |        |&lt;-(D)- Protected Resource --| Resource |   | Authorization |
       | Client |                            |  Server  |   |     Server    |
       |        |--(E)---- Access Token ----&gt;|          |   |               |
       |        |                            |          |   |               |
       |        |&lt;-(F)- Invalid Token Error -|          |   |               |
       |        |                            +----------+   |               |
       |        |                                           |               |
       |        |--(G)----------- Refresh Token -----------&gt;|               |
       |        |                                           |               |
       |        |&lt;-(H)----------- Access Token -------------|               |
       +--------+           &amp; Optional Refresh Token        +---------------+

                 Figure 2: Refreshing an Expired Access Token
           (https://datatracker.ietf.org/doc/html/rfc6749#section-1.5)
</code></pre></div><h2 id="clients">Clients<a hidden class="anchor" aria-hidden="true" href="#clients">#</a></h2>
<h3 id="client-registration">Client registration<a hidden class="anchor" aria-hidden="true" href="#client-registration">#</a></h3>
<p>Before initiating the protocol, the client registers with the
authorization server</p>
<p>In order to register a client, client developers needs to:</p>
<ul>
<li>Specify client <em>type</em></li>
<li>Provide client <strong>redirect URIs</strong></li>
</ul>
<h3 id="client-types">Client types<a hidden class="anchor" aria-hidden="true" href="#client-types">#</a></h3>
<p>There are two types of clients:</p>
<ul>
<li><strong>Confidential</strong>: Clients that <em>can</em> keep their credentials confidential (e.g. web applications)</li>
<li><strong>Public</strong>: Clients that <em>cannot</em> keep their credentials confidential (e.g. mobile applications)</li>
</ul>
<p>Clients can have multiple components, such as a web application and a mobile application. In this case, the client
have different client types and security context and should be registered <em>separately</em>.</p>
<p>OAuth 2.0 defines three different classes of clients:</p>
<ul>
<li>web applications: store the client credentials on a server (e.g. web server)</li>
<li>user-agent-based applications: execute code within a user agent (e.g. web browser)</li>
<li>native applications: installed on a user&rsquo;s device (e.g. mobile phone or tablet)</li>
</ul>
<blockquote>
<p>This specification has been designed around the following client
profiles:</p>
<ul>
<li>
<p>web application</p>
<p>A web application is a confidential client running on a web
server.  Resource owners access the client via an HTML user
interface rendered in a user-agent on the device used by the
resource owner.  The client credentials as well as any access
token issued to the client are stored on the web server and are
not exposed to or accessible by the resource owner.</p>
</li>
<li>
<p>user-agent-based application</p>
<p>A user-agent-based application is a public client in which the
client code is downloaded from a web server and executes within a
user-agent (e.g., web browser) on the device used by the resource
owner.  Protocol data and credentials are easily accessible (and
often visible) to the resource owner.  Since such applications
reside within the user-agent, they can make seamless use of the
user-agent capabilities when requesting authorization.</p>
</li>
<li>
<p>native application</p>
<p>A native application is a public client installed and executed on
the device used by the resource owner.  Protocol data and
credentials are accessible to the resource owner.  It is assumed
that any client authentication credentials included in the
application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can
receive an acceptable level of protection.  At a minimum, these
credentials are protected from hostile servers with which the
application may interact.  On some platforms, these credentials
might be protected from other applications residing on the same
device.</p>
</li>
</ul>
</blockquote>
<h3 id="client-identifier">Client identifier<a hidden class="anchor" aria-hidden="true" href="#client-identifier">#</a></h3>
<p>Client ID is a <strong>unique string that is used to identify the client</strong> application when it requests access to a
user’s resources from an authorization server. It is used to verify that the application is registered and trusted by
the authorization server, and to ensure that the application is not attempting to gain access to resources it does not
have permission to access. It is also used to help the authorization server track the application’s access to the user’s
resources.</p>
<h3 id="client-authentication">Client authentication<a hidden class="anchor" aria-hidden="true" href="#client-authentication">#</a></h3>
<p>Client Authentication is a <strong>process used to verify a client application&rsquo;s identity</strong> when requesting access to a
user&rsquo;s resources from an authorization server. This process helps to ensure that the application is registered and
trusted, and that it is not attempting to gain access to resources it does not have permission to access. The process
typically involves the client application providing a unique identifier and a secret key, which the authorization server
can use to authenticate the client. In addition, the authorization server may require additional authentication methods,
such as a certificate or a user&rsquo;s username and password.</p>
<h3 id="client-password">Client password<a hidden class="anchor" aria-hidden="true" href="#client-password">#</a></h3>
<p>Clients can be assigned a password that is used to authenticate the client when it requests access to a user’s.
It can be used to authenticate with authorization server via the <strong>HTTP Basic authentication scheme</strong>.</p>
<blockquote>
<p>The client identifier is encoded using the
<strong>&ldquo;application/x-www-form-urlencoded&rdquo;</strong> encoding algorithm per
Appendix B, and the encoded value is used as the username; the client
password is encoded using the same algorithm and used as the
password</p>
</blockquote>
<p>E.g.:</p>
<pre><code> Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3
</code></pre>
<p>Alternatively, but <strong>NOT RECOMMENDED</strong>, the client can authenticate with the authorization server using the <strong>client_id</strong> and <strong>client_secret</strong> in
the request body using:</p>
<ul>
<li><strong>client_id</strong> as the username</li>
<li><strong>client_secret</strong> as the password</li>
</ul>
<h2 id="protocol-endpoints">Protocol endpoints<a hidden class="anchor" aria-hidden="true" href="#protocol-endpoints">#</a></h2>
<p>The authorization process utilizes 2 endpoints:</p>
<ul>
<li><strong>Authorization endpoint</strong>: used to interact with the resource owner and obtain an authorization grant.</li>
<li><strong>Token endpoint</strong>: used by the client to obtain an access token by presenting its authorization grant or refresh
token.</li>
</ul>
<h3 id="authorization-endpoint">Authorization endpoint<a hidden class="anchor" aria-hidden="true" href="#authorization-endpoint">#</a></h3>
<p>The authorization endpoint is <strong>used to interact with the resource owner</strong> and obtain an authorization grant.</p>
<p>Response types:</p>
<ul>
<li><strong>code</strong>: for requesting an authorization code.</li>
<li><strong>token</strong>: for requesting an access token (implicit grant).</li>
</ul>
<h3 id="token-endpoint">Token endpoint<a hidden class="anchor" aria-hidden="true" href="#token-endpoint">#</a></h3>
<p>The token endpoint <strong>allows clients to obtain access token and refresh token</strong>. This endpoint is used with every
authorization grant except for the implicit grant type (since an access token is issued directly).</p>
<p>A client will usually send an authorization grant (such as an authorization code) to the token endpoint, and the
endpoint will return an access token and a refresh token. The access token is used to gain access to protected
resources, while the refresh token is used to obtain a new access token when the current one expires.</p>
<p>The token endpoint can also be used to revoke access tokens, and to obtain additional information about the token, such
as its expiration time.</p>
<h2 id="obtaining-authorization">Obtaining Authorization<a hidden class="anchor" aria-hidden="true" href="#obtaining-authorization">#</a></h2>
<h3 id="authorization-code-grant-1">Authorization code grant<a hidden class="anchor" aria-hidden="true" href="#authorization-code-grant-1">#</a></h3>
<p>The authorization code flow involves the following steps:</p>
<ul>
<li>The client initiates the flow by redirecting the user to the authorization server.</li>
<li>The user authenticates with the authorization server and grants the client access.</li>
<li>The authorization server sends an authorization code back to the client application.</li>
<li>The client application exchanges the authorization code for an access token.</li>
<li>The client application can use the access token to make API requests.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">            +----------+
            | Resource |
            |   Owner  |
            |          |
            +----------+
                 ^
                 |
                (B)
            +----|-----+          Client Identifier      +---------------+
            |         -+----(A)-- &amp; Redirection URI ----&gt;|               |
            |  User-   |                                 | Authorization |
            |  Agent  -+----(B)-- User authenticates ---&gt;|     Server    |
            |          |                                 |               |
            |         -+----(C)-- Authorization Code ---&lt;|               |
            +-|----|---+                                 +---------------+
              |    |                                         ^      v
             (A)  (C)                                        |      |
              |    |                                         |      |
              ^    v                                         |      |
            +---------+                                      |      |
            |         |&gt;---(D)-- Authorization Code ---------&#39;      |
            |  Client |          &amp; Redirection URI                  |
            |         |                                             |
            |         |&lt;---(E)----- Access Token -------------------&#39;
            +---------+       (w/ Optional Refresh Token)

        Note: The lines illustrating steps (A), (B), and (C) are broken into
        two parts as they pass through the user-agent.

                          Figure 3: Authorization Code Flow
              (https://datatracker.ietf.org/doc/html/rfc6749#section-4.1)
</code></pre></div><h3 id="implicit-grant-1">Implicit grant<a hidden class="anchor" aria-hidden="true" href="#implicit-grant-1">#</a></h3>
<p>The implicit grant flow involves the following steps:</p>
<ul>
<li>The client initiates the flow by redirecting the user to the authorization server.</li>
<li>The user authenticates with the authorization server and grants the client access.</li>
<li>The authorization server sends an access token back to the client application.</li>
<li>The client application can use the access token to make API requests.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">
           +----------+
           | Resource |
           |  Owner   |
           |          |
           +----------+
                ^
                |
               (B)
           +----|-----+          Client Identifier     +---------------+
           |         -+----(A)-- &amp; Redirection URI ---&gt;|               |
           |  User-   |                                | Authorization |
           |  Agent  -|----(B)-- User authenticates --&gt;|     Server    |
           |          |                                |               |
           |          |&lt;---(C)--- Redirection URI ----&lt;|               |
           |          |          with Access Token     +---------------+
           |          |            in Fragment
           |          |                                +---------------+
           |          |----(D)--- Redirection URI ----&gt;|   Web-Hosted  |
           |          |          without Fragment      |     Client    |
           |          |                                |    Resource   |
           |     (F)  |&lt;---(E)------- Script ---------&lt;|               |
           |          |                                +---------------+
           +-|--------+
             |    |
            (A)  (G) Access Token
             |    |
             ^    v
           +---------+
           |         |
           |  Client |
           |         |
           +---------+

         Note: The lines illustrating steps (A) and (B) are broken into two
         parts as they pass through the user-agent.

                        Figure 4: Implicit Grant Flow
            (https://datatracker.ietf.org/doc/html/rfc6749#section-4.2)
</code></pre></div><h3 id="resource-owner-password-credentials-grant-1">Resource owner password credentials grant<a hidden class="anchor" aria-hidden="true" href="#resource-owner-password-credentials-grant-1">#</a></h3>
<p>The resource owner password credentials grant flow involves the following steps:</p>
<ul>
<li>The client application requests an access token from the authorization server by providing the resource owner&rsquo;s
credentials.</li>
<li>The authorization server validates the credentials and sends an access token back to the client application.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">           +----------+
           | Resource |
           |  Owner   |
           |          |
           +----------+
                v
                |    Resource Owner
               (A) Password Credentials
                |
                v
           +---------+                                  +---------------+
           |         |&gt;--(B)---- Resource Owner -------&gt;|               |
           |         |         Password Credentials     | Authorization |
           | Client  |                                  |     Server    |
           |         |&lt;--(C)---- Access Token ---------&lt;|               |
           |         |    (w/ Optional Refresh Token)   |               |
           +---------+                                  +---------------+

                Figure 5: Resource Owner Password Credentials Flow
            (https://datatracker.ietf.org/doc/html/rfc6749#section-4.3)
</code></pre></div><h3 id="client-credentials-grant-1">Client credentials grant<a hidden class="anchor" aria-hidden="true" href="#client-credentials-grant-1">#</a></h3>
<p>The client credentials grant flow involves the following steps:</p>
<ul>
<li>The client application requests an access token from the authorization server by providing its client credentials.</li>
<li>The authorization server validates the credentials and sends an access token back to the client application.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">         +---------+                                  +---------------+
         |         |&gt;--(A)- Client Authentication ---&gt;|               |
         | Client  |                                  | Authorization |
         |         |&lt;--(B)---- Access Token ---------&lt;|     Server    |
         |         |    (w/ Optional Refresh Token)   |               |
         +---------+                                  +---------------+

                    Figure 6: Client Credentials Flow
          (https://datatracker.ietf.org/doc/html/rfc6749#section-4.4)
</code></pre></div>
</div>
    <footer class="post-footer">
        <ul class="post-tags">
            <li><a href="https://blog.nguyentritai.io/tags/authentication/">Authentication</a></li>
            <li><a href="https://blog.nguyentritai.io/tags/authorization/">Authorization</a></li>
            <li><a href="https://blog.nguyentritai.io/tags/oauth2/">OAuth2</a></li>
        </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.nguyentritai.io/posts/2023/ufw/">
    <span class="title">« Prev Page</span>
    <br>
    <span>UFW with Docker</span>
  </a>
  <a class="next" href="https://blog.nguyentritai.io/posts/2022/tensorboard-projector-image-visualizer/">
    <span class="title">Next Page »</span>
    <br>
    <span>Tensorboard Projector Image Visualizer with Tensorflow 2</span>
  </a>
</nav>

<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Oauth2 - The concept on twitter"
        href="https://twitter.com/intent/tweet/?text=Oauth2%20-%20The%20concept&amp;url=https%3a%2f%2fblog.nguyentritai.io%2fposts%2f2023%2foauth2%2f&amp;hashtags=Authentication%2cAuthorization%2cOAuth2">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Oauth2 - The concept on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.nguyentritai.io%2fposts%2f2023%2foauth2%2f&amp;title=Oauth2%20-%20The%20concept&amp;summary=Oauth2%20-%20The%20concept&amp;source=https%3a%2f%2fblog.nguyentritai.io%2fposts%2f2023%2foauth2%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Oauth2 - The concept on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fblog.nguyentritai.io%2fposts%2f2023%2foauth2%2f&title=Oauth2%20-%20The%20concept">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Oauth2 - The concept on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.nguyentritai.io%2fposts%2f2023%2foauth2%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Oauth2 - The concept on whatsapp"
        href="https://api.whatsapp.com/send?text=Oauth2%20-%20The%20concept%20-%20https%3a%2f%2fblog.nguyentritai.io%2fposts%2f2023%2foauth2%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Oauth2 - The concept on telegram"
        href="https://telegram.me/share/url?text=Oauth2%20-%20The%20concept&amp;url=https%3a%2f%2fblog.nguyentritai.io%2fposts%2f2023%2foauth2%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

    </footer>

    <div id="comments"></div>


<script>
    function getTheme() {
        const light = "github-light"
        const dark = "github-dark"
        if (localStorage.getItem("pref-theme") === "light") {
            return light;
        } else {
            return dark;
        }
    }

    function loadUtterances() {
        const commentsContainer = document.getElementById("comments");
        if (commentsContainer !== null) {
            commentsContainer.innerHTML = ''
            const utterancesScript = document.createElement("script");
            utterancesScript.setAttribute("id", "utterances");
            utterancesScript.setAttribute("src", "https://utteranc.es/client.js");
            utterancesScript.setAttribute("repo", "nguyentritai2906/nguyentritai2906.github.io");
            utterancesScript.setAttribute("issue-term", "pathname");
            utterancesScript.setAttribute("theme", getTheme());
            utterancesScript.setAttribute("crossorigin", "anonymous");
            utterancesScript.setAttribute("async", "true");

            commentsContainer.appendChild(utterancesScript);
        }
    }

    loadUtterances();
</script>

</article>
    </main>
    <footer class="footer">
    <span>&copy; 2023 <a href="https://blog.nguyentritai.io/">Nguyen Tri Tai</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>

<script>
    window.onload = function() {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function(e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function() {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
            const message = {
                type: 'set-theme',
                theme: 'github-light'
            };
            var utterances = document.querySelector('iframe');
            utterances.contentWindow.postMessage(message, 'https://utteranc.es');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
            const message = {
                type: 'set-theme',
                theme: 'github-dark'
            };
            var utterances = document.querySelector('iframe');
            utterances.contentWindow.postMessage(message, 'https://utteranc.es');
        }
    })
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {};
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
